String.prototype.toUTF8Array=function(){var t,e,r,n,i;i=0;for(t=i=0,e=this.length;t<e;++t){r=this.charCodeAt(t);if(r>=55296&&r<=57343){n=this.charCodeAt(++t);r=(r-55296<<10|n-56320)+65536}i+=r<2048?r<128?1:2:r<65536?3:4}var o=new ArrayBuffer(i);var a=new Uint8Array(o);for(t=i=0,e=this.length;t<e;++t){r=this.charCodeAt(t);if(r>=55296&&r<=57343){n=this.charCodeAt(++t);r=(r-55296<<10|n-56320)+65536}if(r<2048){if(r<128){a[i++]=r}else{a[i++]=192|r>>>6&31;a[i++]=128|r&63}}else{if(r<65536){a[i++]=224|r>>>12&15;a[i++]=128|r>>>6&63;a[i++]=128|r&63}else{a[i++]=240|r>>>18&7;a[i++]=128|r>>>12&63;a[i++]=128|r>>>6&63;a[i++]=128|r&63}}}return a};String.prototype.decodeBase64=function(){var t,e,r,n,i;for(e=this.length;e>0&&this.charAt(e-1)=="=";--e);i=e&3;if(i==1){console.log("sz_1");return false}i=(e>>>2)*3+(i==0?0:i==2?1:2);var o=new ArrayBuffer(i);var a=new Uint8Array(o);i=0;for(r=t=0;t<e;++t){n=this.charCodeAt(t);if(48<=n&&n<=57)n=n-48+52;else if(65<=n&&n<=90)n=n-65;else if(97<=n&&n<=122)n=n-97+26;else if(n==43)n=62;else if(n==47)n=63;else{console.log("char["+t+']:"'+this.charAt(t)+'"');return false}r=r<<6|n;if((t&3)==1){a[i++]=r>>>4;r&=15}else if((t&3)==2){a[i++]=r>>>2;r&=3}else if((t&3)==3){a[i++]=r;r=0}}return a};Uint8Array.prototype.toUTF8String=function(){var t=[127,31,15,7];var e=[128,224,240,248];var r=[0,192,224,240];var n="";var i,o,a,s,f;for(i=0,o=this.length;i<o;i+=a+1){s=this[i];a=s<224?s<192?0:1:s<240?2:3;if((s&e[a])!=r[a])return false;s&=t[a];for(j=0;j<a&&i+j+1<o;++j){f=this[i+j+1];if((f&192)!=128)return false;s=s<<6|f&63}if(s>=65536){s-=65536;n+=String.fromCharCode(55296+(s>>>10))+String.fromCharCode(56320+(s&1023))}else{n+=String.fromCharCode(s)}}return n};Uint8Array.prototype.encodeBase64=function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var e,r,n,i;var o="";for(e=n=0,r=this.length;e<r;++e){n=n<<8|this[e];if(e%3==0){o+=t[n>>>2];n&=3}else if(e%3==1){o+=t[n>>>4];n&=15}else{o+=t[n>>>6];o+=t[n&63];n=0}}if(e%3==1)o+=t[n<<4]+"==";else if(e%3==2)o+=t[n<<2]+"=";return o};Uint8Array.prototype.toHexString=function(){var t=[];for(let e=0;e<this.length;++e)t.push(("00"+this[e].toString(16)).slice(-2));return t.join("")};String.prototype.toHexArray=function(){var t=this.length>>>1;var e=new Uint8Array(t);for(let r=0;r<t;++r)e[r]=parseInt(this.slice(r<<1,(r<<1)+2),16);return e};var sha2=function(){var t="agnmZ/O8yQi7Z66FhMqnOzxu83L+lPgrpU/1Ol8dNvFRDlJ/reaC0ZsFaIwrPmwfH4PZq/tBvWtb4M0ZE34heQ==";var e="QoovmNcoriJxN0SRI+9lzbXA+8/sTTsv6bXbpYGJ27w5VsJb80i1OFnxEfG2BdAZkj+CpK8ZT5urHF7V2m2BGNgHqpijAwJCEoNbAUVwb74kMYW+TuSyjFUMfcPV/7Ticr5ddPJ7iW+A3rH+OxaWsZvcBqclxxI1wZvxdM9pJpTkm2nBnvFK0u++R4Y4TyXjD8GdxouM1bUkDKHMd6ycZS3pLG9ZKwJ1SnSEqm6m5INcsKncvUH71Hb5iNqDEVO1mD5RUu5m36uoMcZtLbQyELADJ8iY+yE/v1l/x77vDuTG4AvzPaiPwtWnkUeTCqclBspjUeADgm8UKSlnCg5ucCe3CoVG0i/8LhshOFwmySZNLG38WsQq7VM4DROdlbPfZQpzVIuvY952agq7PHeyqIHCyS5H7a7mknIshRSCNTuiv+ihTPEDZKgaZku8QjABwkuLcND4l5HHbFGjBlS+MNGS6BnW71IY1pkGJFVlqRD0DjWFV3EgKhBqoHAyu9G4GaTBFrjS0MgeN2wIUUGrUydId0zfjuuZNLC8teGbSKg5HAyzxclaY07YqkrjQYrLW5zKT3dj43NoLm/z1rK4o3SPgu5d77L8eKVjb0MXL2CEyHgUofCrcozHAggaZDnskL7/+iNjHiikUGzr3oK96b75o/eyxnkVxnF48uNyUyvKJz7O6iZhnNGGuMchwMIH6tp91s3g6x71fU9/7m7ReAbwZ6pyF2+6CmN9xaLImKYRP5gEvvkNrhtxCzUTHEcbKNt39SMEfYQyyqt7QMckkzyevgoVyb68Qx1nxJwQDUxMxdS+yz5Ctll/KZz8ZX4qX8tvqzrW+uxsRBmMSkdYFw==";var r="agnmZ7tnroU8bvNypU/1OlEOUn+bBWiMH4PZq1vgzRk=";var n="QoovmHE3RJG1wPvP6bXbpTlWwltZ8RHxkj+CpKscXtXYB6qYEoNbASQxhb5VDH3Dcr5ddIDesf6b3AanwZvxdOSbacHvvkeGD8GdxiQMocwt6SxvSnSEqlywqdx2+YjamD5RUqgxxm2wAyfIv1l/x8bgC/PVp5FHBspjURQpKWcntwqFLhshOE0sbfxTOA0TZQpzVHZqCruBwskuknIshaK/6KGoGmZLwkuLcMdsUaPRkugZ1pkGJPQONYUQaqBwGaTBFh43bAgnSHdMNLC8tTkcDLNO2KpKW5zKT2gub/N0j4LueKVjb4TIeBSMxwIIkL7/+qRQbOu++aP3xnF48g==";var i="y7udXcEFnthimikqNnzVB5FZAVowcN0XFS/s2PcOWTlnMyZn/8ALMY60SodoWBUR2wwuDWT5j6dHtUgdvvpPpA==";var o="jD03yBlUTaJz4ZlmidzU1h36t64y/5yCZ53VFFgvn88PbStpe9RNqHfjb3MExIlCP52FqGodNsgREuatkdaSoQ==";var a="IjEhlPwr9yyfVV+jyExkwiOTuGtvU7FRljh3GVlA6r2WKD7iqI7/475eHiVThjmSKwGZ/CyFuKoOty3cgcUsog==";var s="wQWe2DZ81QcwcN0X9w5ZOf/ACzFoWBURZPmPp776T6Q=";t=t.decodeBase64();e=e.decodeBase64();r=r.decodeBase64();n=n.decodeBase64();i=i.decodeBase64();s=s.decodeBase64();o=o.decodeBase64();a=a.decodeBase64();var f={w_and:function(t,e,r,n,i,o){var a=r.getUint32(n<<2)&i.getUint32(o<<2);t.setUint32(e<<2,a)},w_or:function(t,e,r,n,i,o){var a=r.getUint32(n<<2)|i.getUint32(o<<2);t.setUint32(e<<2,a)},w_xor:function(t,e,r,n,i,o){var a=r.getUint32(n<<2)^i.getUint32(o<<2);t.setUint32(e<<2,a)},w_not:function(t,e,r,n){var i=~r.getUint32(n<<2);t.setUint32(e<<2,i)},w_add:function(t,e,r,n,i,o){var a=r.getUint32(n<<2),s=i.getUint32(o<<2);var f=(a&65535)+(s&65535);var w=(a>>>16)+(s>>>16)+(f>>>16);t.setUint32(e<<2,(w&65535)<<16|f&65535)},w_shift:function(t,e,r,n,i){var o=r.getUint32(n<<2)>>>i;t.setUint32(e<<2,o)},w_rotate:function(t,e,r,n,i){var o=r.getUint32(n<<2);t.setUint32(e<<2,o>>>i|o<<32-i)},w_set:function(t,e,r,n){var i=r.getUint32(n<<2);t.setUint32(e<<2,i)},c_sum0:[2,13,22],c_sum1:[6,11,25],c_sig0:[7,18,3],c_sig1:[17,19,10]};var w={w_and:function(t,e,r,n,i,o){var a=r.getUint32(n<<3)&i.getUint32(o<<3),s=r.getUint32((n<<3)+4)&i.getUint32((o<<3)+4);t.setUint32(e<<3,a);t.setUint32((e<<3)+4,s)},w_or:function(t,e,r,n,i,o){var a=r.getUint32(n<<3)|i.getUint32(o<<3),s=r.getUint32((n<<3)+4)|i.getUint32((o<<3)+4);t.setUint32(e<<3,a);t.setUint32((e<<3)+4,s)},w_xor:function(t,e,r,n,i,o){var a=r.getUint32(n<<3)^i.getUint32(o<<3),s=r.getUint32((n<<3)+4)^i.getUint32((o<<3)+4);t.setUint32(e<<3,a);t.setUint32((e<<3)+4,s)},w_not:function(t,e,r,n){var i=~r.getUint32(n<<3),o=~r.getUint32((n<<3)+4);t.setUint32(e<<3,i);t.setUint32((e<<3)+4,o)},w_add:function(t,e,r,n,i,o){var a=r.getUint32(n<<3),s=r.getUint32((n<<3)+4);var f=i.getUint32(o<<3),w=i.getUint32((o<<3)+4);var c=(s&65535)+(w&65535);var u=(s>>>16)+(w>>>16)+(c>>>16);t.setUint32((e<<3)+4,(u&65535)<<16|c&65535);c=(a&65535)+(f&65535)+(u>>>16);u=(a>>>16)+(f>>>16)+(c>>>16);t.setUint32(e<<3,(u&65535)<<16|c&65535)},w_shift:function(t,e,r,n,i){var o=r.getUint32(n<<3),a=r.getUint32((n<<3)+4);if(i<32){t.setUint32(e<<3,o>>>i);t.setUint32((e<<3)+4,o<<32-i|a>>>i)}else{t.setUint32(e<<3,0);t.setUint32((e<<3)+4,o>>>i-32)}},w_rotate:function(t,e,r,n,i){var o=r.getUint32(n<<3),a=r.getUint32((n<<3)+4);if(i<32){t.setUint32(e<<3,a<<32-i|o>>>i);t.setUint32((e<<3)+4,o<<32-i|a>>>i)}else{i-=32;t.setUint32((e<<3)+4,a<<32-i|o>>>i);t.setUint32(e<<3,o<<32-i|a>>>i)}},w_set:function(t,e,r,n){var i=r.getUint32(n<<3),o=r.getUint32((n<<3)+4);t.setUint32(e<<3,i);t.setUint32((e<<3)+4,o)},c_sum0:[28,34,39],c_sum1:[14,18,41],c_sig0:[1,8,7],c_sig1:[19,61,6]};var c={224:{wordSize:4,wordSizePow:2,H0:s,K:n,op:f,outputLen:28},256:{wordSize:4,wordSizePow:2,H0:r,K:n,op:f},512:{wordSize:8,wordSizePow:3,H0:t,K:e,op:w},384:{wordSize:8,wordSizePow:3,H0:i,K:e,op:w,outputLen:48},"512/224":{wordSize:8,wordSizePow:3,H0:o,K:e,op:w,outputLen:28},"512/256":{wordSize:8,wordSizePow:3,H0:a,K:e,op:w,outputLen:32}};return function(t,e){if(!c[t])return false;var r=c[t].wordSize,n=c[t].wordSizePow,i=c[t].H0,o=c[t].K,a=c[t].op;var s=e.length;var f=s+r*20>>>n+4<<n+4;var w=new ArrayBuffer(f);var u=new Uint8Array(w),d=new DataView(w);u.set(e);u[s]=128;u[f-1]=(s&31)<<3;for(let t=1;t<4;++t)u[f-1-t]=s>>>8*t-3&255;var y=i.buffer.slice(),v=new ArrayBuffer(r*8),h=new ArrayBuffer(r*16),g=new ArrayBuffer(o.length);var U=new DataView(y),p=new Uint8Array(y),l=new DataView(v),A=new Uint8Array(v),S=new DataView(h),_=new Uint8Array(h),b=new DataView(o.buffer);dvW=new DataView(g),u8W=new Uint8Array(g);var x=f>>>n+4,B=o.length>>>n;for(let t=0;t<x;++t){A.set(p);for(j=0;j<B;++j){a.w_set(S,0,l,7);a.w_rotate(S,1,l,4,a.c_sum1[0]);a.w_rotate(S,2,l,4,a.c_sum1[1]);a.w_xor(S,1,S,1,S,2);a.w_rotate(S,2,l,4,a.c_sum1[2]);a.w_xor(S,1,S,1,S,2);a.w_add(S,0,S,0,S,1);a.w_and(S,1,l,4,l,5);a.w_not(S,2,l,4);a.w_and(S,2,S,2,l,6);a.w_xor(S,1,S,1,S,2);a.w_add(S,0,S,0,S,1);a.w_add(S,0,S,0,b,j);if(j<16){a.w_set(dvW,j,d,16*t+j)}else{a.w_rotate(S,1,dvW,j-2,a.c_sig1[0]);a.w_rotate(S,2,dvW,j-2,a.c_sig1[1]);a.w_xor(S,1,S,1,S,2);a.w_shift(S,2,dvW,j-2,a.c_sig1[2]);a.w_xor(dvW,j,S,1,S,2);a.w_add(dvW,j,dvW,j,dvW,j-7);a.w_rotate(S,1,dvW,j-15,a.c_sig0[0]);a.w_rotate(S,2,dvW,j-15,a.c_sig0[1]);a.w_xor(S,1,S,1,S,2);a.w_shift(S,2,dvW,j-15,a.c_sig0[2]);a.w_xor(S,1,S,1,S,2);a.w_add(dvW,j,dvW,j,S,1);a.w_add(dvW,j,dvW,j,dvW,j-16)}a.w_add(S,0,S,0,dvW,j);a.w_rotate(S,1,l,0,a.c_sum0[0]);a.w_rotate(S,2,l,0,a.c_sum0[1]);a.w_xor(S,1,S,1,S,2);a.w_rotate(S,2,l,0,a.c_sum0[2]);a.w_xor(S,1,S,1,S,2);a.w_and(S,2,l,0,l,1);a.w_and(S,3,l,0,l,2);a.w_xor(S,2,S,2,S,3);a.w_and(S,3,l,1,l,2);a.w_xor(S,2,S,2,S,3);a.w_add(S,1,S,1,S,2);a.w_set(l,7,l,6);a.w_set(l,6,l,5);a.w_set(l,5,l,4);a.w_add(l,4,l,3,S,0);a.w_set(l,3,l,2);a.w_set(l,2,l,1);a.w_set(l,1,l,0);a.w_add(l,0,S,0,S,1)}for(let t=0;t<8;++t)a.w_add(U,t,U,t,l,t)}if(c[t].outputLen)return p.slice(0,c[t].outputLen);return p;function m(t,e){a.w_shift(t,1,e,2,e,13);a.w_shift(t,0,t,1,e,22)}}}();function hmac_sha2(t,e,r){var n={224:[64,28],256:[64,32],384:[128,48],512:[128,64],"512/224":[128,28],"512/256":[128,32]};if(!n[t])return false;var i=n[t][0],o=n[t][1];if(r.length>i){r=sha2(t,r)}if(r.length<i){let t=new Uint8Array(i);t.set(r);r=t}var a=new Uint8Array(i+o);a.set(r);var s=new Uint8Array(i+e.length);s.set(r);for(let t=0;t<i;++t){a[t]^=92;s[t]^=54}s.set(e,i);var f=sha2(t,s);a.set(f,i);return sha2(t,a)}function AES(t){this.keyInfo=this.getRoundKeys(t)}(function(){var t="Y3x3e/Jrb8UwAWcr/terdsqCyX36WUfwrdSir5ykcsC3/ZMmNj/3zDSl5fFx2DEVBMcjwxiWBZoHEoDi6yeydQmDLBobblqgUjvWsynjL4RT0QDtIPyxW2rLvjlKTFjP0O+q+0NNM4VF+QJ/UDyfqFGjQI+SnTj1vLbaIRD/89LNDBPsX5dEF8Snfj1kXRlzYIFP3CIqkIhG7rgU3l4L2+AyOgpJBiRcwtOsYpGV5HnnyDdtjdVOqWxW9Opleq4IunglLhymtMbo3XQfS72LinA+tWZIA/YOYTVXuYbBHZ7h+JgRadmOlJseh+nOVSjfjKGJDb/mQmhBmS0PsFS7Fg==";var e="Uglq1TA2pTi/QKOegfPX+3zjOYKbL/+HNI5DRMTe6ctUe5QypsIjPe5MlQtC+sNOCC6hZijZJLJ2W6JJbYvRJXL49mSGaJgW1KRczF1ltpJscEhQ/e252l4VRlenjZ2EkNirAIy80wr35FgFuLNFBtAsHo/KPw8Cwa+9AwETims6kRFBT2fc6pfyz87wtOZzlqx0IuetNYXi+TfoHHXfbkfxGnEdKcWJb7diDqoYvhv8Vj5LxtJ5IJrbwP54zVr0H92oM4gHxzGxEhBZJ4DsX2BRf6kZtUoNLeV6n5PJnO+g4DtNrir1sMjruzyDU5lhFysEfrp31ibhaRRjVSEMfQ==";var r=[];r[2]="AAIEBggKDA4QEhQWGBocHiAiJCYoKiwuMDI0Njg6PD5AQkRGSEpMTlBSVFZYWlxeYGJkZmhqbG5wcnR2eHp8foCChIaIioyOkJKUlpianJ6goqSmqKqsrrCytLa4ury+wMLExsjKzM7Q0tTW2Nrc3uDi5Obo6uzu8PL09vj6/P4bGR8dExEXFQsJDw0DAQcFOzk/PTMxNzUrKS8tIyEnJVtZX11TUVdVS0lPTUNBR0V7eX99c3F3dWtpb21jYWdlm5mfnZORl5WLiY+Ng4GHhbu5v72zsbe1q6mvraOhp6Xb2d/d09HX1cvJz83DwcfF+/n//fPx9/Xr6e/t4+Hn5Q==";r[3]="AAMGBQwPCgkYGx4dFBcSETAzNjU8Pzo5KCsuLSQnIiFgY2ZlbG9qaXh7fn10d3JxUFNWVVxfWllIS05NREdCQcDDxsXMz8rJ2Nve3dTX0tHw8/b1/P/6+ejr7u3k5+LhoKOmpayvqqm4u769tLeysZCTlpWcn5qZiIuOjYSHgoGbmJ2el5SRkoOAhYaPjImKq6itrqekoaKzsLW2v7y5uvv4/f739PHy4+Dl5u/s6erLyM3Ox8TBwtPQ1dbf3NnaW1hdXldUUVJDQEVGT0xJSmtobW5nZGFic3B1dn98eXo7OD0+NzQxMiMgJSYvLCkqCwgNDgcEAQITEBUWHxwZGg==";r[9]="AAkSGyQtNj9IQVpTbGV+d5CZgou0vaav2NHKw/z17uc7MikgHxYNBHN6YWhXXkVMq6K5sI+GnZTj6vH4x87V3HZ/ZG1SW0BJPjcsJRoTCAHm7/T9wsvQ2a6nvLWKg5iRTURfVmlge3IFDBceISgzOt3Uz8b58OvilZyHjrG4o6rs5f73yMHa06Sttr+AiZKbfHVuZ1hRSkM0PSYvEBkCC9fexczz+uHon5aNhLuyqaBHTlVcY2pxeA8GHRQrIjkwmpOIgb63rKXS28DJ9v/k7QoDGBEuJzw1QktQWWZvdH2hqLO6hYyXnung+/LNxN/WMTgjKhUcBw55cGtiXVRPRg==";r[11]="AAsWHSwnOjFYU05FdH9iabC7pq2cl4qB6OP+9cTP0tl7cG1mV1xBSiMoNT4PBBkSy8Dd1ufs8fqTmIWOv7Spovb94Ova0czHrqW4s4KJlJ9GTVBbamF8dx4VCAMyOSQvjYabkKGqt7zV3sPI+fLv5D02KyARGgcMZW5zeElCX1T3/OHq29DNxq+kubKDiJWeR0xRWmtgfXYfFAkCMzglLoyHmpGgq7a91N/Cyfjz7uU8NyohEBsGDWRvcnlIQ15VAQoXHC0mOzBZUk9EdX5jaLG6p6ydlouA6eL/9MXO09h6cWxnVl1ASyIpND8OBRgTysHc1+bt8PuSmYSPvrWoow==";r[13]="AA0aFzQ5LiNoZXJ/XFFGS9Ddysfk6f7zuLWir4yBlpu7tqGsj4KVmNPeycTn6v3wa2ZxfF9SRUgDDhkUNzotIG1gd3pZVENOBQgfEjE8Kya9sKeqiYSTntXYz8Lh7Pv21tvMweLv+PW+s6SpioeQnQYLHBEyPyglbmN0eVpXQE3a18DN7uP0+bK/qKWGi5yRCgcQHT4zJClib3h1VltMQWFse3ZVWE9CCQQTHj0wJyqxvKumhYifktnUw87t4Pf6t7qtoIOOmZTf0sXI6+bx/GdqfXBTXklEDwIVGDs2ISwMARYbODUiL2RpfnNQXUpH3NHGy+jl8v+0ua6jgI2alw==";r[14]="AA4cEjg2JCpwfmxiSEZUWuDu/PLY1sTKkJ6MgqimtLrb1cfJ4+3/8ault7mTnY+BOzUnKQMNHxFLRVdZc31vYa2jsb+Vm4mH3dPBz+Xr+fdNQ1FfdXtpZz0zIS8FCxkXdnhqZE5AUlwGCBoUPjAiLJaYioSuoLK85uj69N7QwsxBT11TeXdlazE/LSMJBxUboa+9s5mXhYvR383D6ef1+5qUhoiirL6w6uT2+NLczsB6dGZoQkxeUAoEFhgyPC4g7OLw/tTayMackoCOpKq4tgwCEB40OigmfHJgbkRKWFY3OSslDwETHUdJW1V/cWNt19nLxe/h8/2nqbu1n5GDjQ==";AES.prototype.sbox=t.decodeBase64();AES.prototype.sbox_r=e.decodeBase64();var n;for(n in r)r[n]=r[n].decodeBase64();AES.prototype.gf_mul=r})();AES.prototype.getRoundKeys=function(t){var e=this.sbox;var r=[];r[16]=4;r[24]=6;r[32]=8;var n=[];n[16]=10;n[24]=12;n[32]=14;var i=r[t.length];var o=n[t.length];var a=new Uint8Array(16*(o+1));var s,f=[1,2,4,8,16,32,64,128,27,54],w=0;for(s=0;s<i*4;++s)a[s]=t[s];for(s=i;s<4*(o+1);++s){if(s%i==0){a[s*4]=a[(s-i)*4]^(e[a[s*4-3]]^f[w++]);a[s*4+1]=a[(s-i)*4+1]^e[a[s*4-2]];a[s*4+2]=a[(s-i)*4+2]^e[a[s*4-1]];a[s*4+3]=a[(s-i)*4+3]^e[a[s*4-4]]}else if(i>6&&s%i==4){a[s*4]=a[(s-i)*4]^e[a[s*4-4]];a[s*4+1]=a[(s-i)*4+1]^e[a[s*4-3]];a[s*4+2]=a[(s-i)*4+2]^e[a[s*4-2]];a[s*4+3]=a[(s-i)*4+3]^e[a[s*4-1]]}else{a[s*4]=a[(s-i)*4]^a[s*4-4];a[s*4+1]=a[(s-i)*4+1]^a[s*4-3];a[s*4+2]=a[(s-i)*4+2]^a[s*4-2];a[s*4+3]=a[(s-i)*4+3]^a[s*4-1]}}return{nr:o,rk:a}};AES.prototype.subBytes=function(t,e,r){var n;for(n=0;n<16;++n)t[e+n]=r[t[e+n]]};AES.prototype.shiftRows=function(t,e,r){var n,i,o;for(n=1;n<4;++n){i=t[e+n]<<24|t[e+n+4]<<16|t[e+n+8]<<8|t[e+n+12];i=i<<r*n%32|i>>>(32-r)*n%32;t[e+n]=i>>>24&255;t[e+n+4]=i>>>16&255;t[e+n+8]=i>>>8&255;t[e+n+12]=i&255}};AES.prototype.mixColumns=function(t,e,r){var n,i,o=[];var a=this.gf_mul;if(r==1){for(n=0;n<16;n+=4){for(i=0;i<4;++i)o[i]=t[e+n+i];t[e+n]=a[2][o[0]]^a[3][o[1]]^o[2]^o[3];t[e+n+1]=o[0]^a[2][o[1]]^a[3][o[2]]^o[3];t[e+n+2]=o[0]^o[1]^a[2][o[2]]^a[3][o[3]];t[e+n+3]=a[3][o[0]]^o[1]^o[2]^a[2][o[3]]}}else{for(n=0;n<16;n+=4){for(i=0;i<4;++i)o[i]=t[e+n+i];t[e+n]=a[14][o[0]]^a[11][o[1]]^a[13][o[2]]^a[9][o[3]];t[e+n+1]=a[9][o[0]]^a[14][o[1]]^a[11][o[2]]^a[13][o[3]];t[e+n+2]=a[13][o[0]]^a[9][o[1]]^a[14][o[2]]^a[11][o[3]];t[e+n+3]=a[11][o[0]]^a[13][o[1]]^a[9][o[2]]^a[14][o[3]]}}};AES.prototype.addRoundKey=function(t,e,r,n){for(i=0;i<16;++i)t[e+i]^=r[n+i]};AES.prototype.chiper=function(t,e){var r=this.keyInfo.rk;var n=this.keyInfo.nr;this.addRoundKey(t,e,r,0);var i;for(i=1;i<n;++i){this.subBytes(t,e,this.sbox);this.shiftRows(t,e,8);this.mixColumns(t,e,1);this.addRoundKey(t,e,r,16*i)}this.subBytes(t,e,this.sbox);this.shiftRows(t,e,8);this.addRoundKey(t,e,r,16*i)};AES.prototype.invChiper=function(t,e){var r=this.keyInfo.rk;var n=this.keyInfo.nr;this.addRoundKey(t,e,r,n*16);this.shiftRows(t,e,24);this.subBytes(t,e,this.sbox_r);var i;for(i=n-1;i>0;--i){this.addRoundKey(t,e,r,16*i);this.mixColumns(t,e,-1);this.shiftRows(t,e,24);this.subBytes(t,e,this.sbox_r)}this.addRoundKey(t,e,r,0)};Uint8Array.prototype.aes_cbc_zero_enc=function(t){var e=new AES(t);var r=(this.length+15+16)/16|0;var n=new Uint8Array(r*16);var i,o,a;for(i=0;i<16;++i)n[i]=Math.random()*256|0;n.set(this,16);for(i=1;i<r;++i){for(o=0;o<16;++o)n[i*16+o]^=n[(i-1)*16+o];e.chiper(n,i*16)}return n};Uint8Array.prototype.aes_cbc_zero_dec=function(t){var e=new AES(t);var r=this.subarray(16);var n=r.length/16|0;var i,o;for(i=n-1;i>0;--i){console.log("decode block:"+i);e.invChiper(r,i*16);for(o=0;o<16;++o)r[i*16+o]^=r[(i-1)*16+o]}e.invChiper(r,0);for(o=0;o<16;++o)r[o]^=this[o];return r};String.prototype.bin=function(t){if(!t)t="utf8";return{utf8:String.prototype.toUTF8Array,base64:String.prototype.decodeBase64,hex:String.prototype.toHexArray}[t].apply(this)};Uint8Array.prototype.str=function(t){if(!t)t="utf8";return{utf8:Uint8Array.prototype.toUTF8String,base64:Uint8Array.prototype.encodeBase64,hex:Uint8Array.prototype.toHexString}[t].apply(this)};if(window.sha2){Uint8Array.prototype.sha2=function(t){return sha2(t,this)};Uint8Array.prototype.hmac_sha2=function(t,e){if(typeof e==="string")e=e.bin("utf8");return hmac_sha2(t,this,e)};String.prototype.hmac_sha2=function(t,e){if(typeof e==="string")e=e.bin("utf8");return hmac_sha2(t,this.bin("utf8"),e)}}if(Uint8Array.prototype.aes_cbc_zero_enc&&Uint8Array.prototype.aes_cbc_zero_dec){Uint8Array.prototype.cipher=function(t,e){return{aes_cbc_zero:Uint8Array.prototype.aes_cbc_zero_enc}[t].apply(this,[e])};Uint8Array.prototype.decipher=function(t,e){return{aes_cbc_zero:Uint8Array.prototype.aes_cbc_zero_dec}[t].apply(this,[e])}}